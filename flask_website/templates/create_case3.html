<html>

<head>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script type=text/javascript>
    $(document).ready(function() {
        console.log("This is changed now")
        
        var dropdown = {
            select_program: $('#program_select'),
            select_project: $('#project_select')
        };

        // call to update on load
        updateProject();
        
        function updateProject() {
            console.log("inside the updateProject() function")
            var send = {
                program_select_var: dropdown.select_program.val()
                };
                dropdown.select_project.attr('disabled', 'disabled');
                dropdown.select_project.empty();
            $.getJSON("{{ url_for('_get_project') }}", send, function(data) {
                $.each(data, function(item)
                    {dropdown.select_project.append(
                        $('<option>', {
                            value: item[0],
                            text: item[1]
                        })
                    );
                });        
            dropdown.select_project.removeAttr('disabled');
            });
        }
        dropdown.select_program.on('change', function() {
            updateProject();
        });
    });
</script>
</head>

<div class="content-section" id='contents_section'>
    <form method="POST" action="/newcase2">
        {{ form.hidden_tag() }}
        <div class="form-group" id='input1'>
            {{ form.program_select.label(class="form-control-label") }} {{ form.program_select }}
            {{ form.project_select.label(class="form-control-label") }} {{ form.project_select }}
            {{ form.submit(class="btn btn-outline-info") }}
        </div>
    </form>
</div>

<div id="other">
    Trigger the handler
</div>

</html>